.\" Automatically generated by Pod::Man 2.16 (Pod::Simple 3.05)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "CBADM-ONLINE-UPDATE 1m"
.TH CBADM-ONLINE-UPDATE 1m "2011-12-08" "" ""
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
cbadm online\-update \- pause persistence and checkpointing for an application update
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.RS 2
\&\fBcbadm online-update\fR host:port start|complete|revert
.RE
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fBcbadm online-update\fR allows for a Couchbase cluster to enter a
state where reads/writes will be accepted and replicated, but
will not be persisted.  This is commonly used to allow for the
deployment of new application code which accesses Couchbase,
followed by verification of the behavior of the application code.
.PP
If the application code behaves correctly, which can be verified
by normal Couchbase operations such as get or \s-1TAP\s0, the online-update
will then be completed, which will re-enable regular persistence and
checkpoint operations on both the master and slaves of that given
master.
.PP
If, on the other hand, the application changes are causing unwanted
changes to data within the system, the online-update should be
reverted, meaning that the state of the data on the Couchbase master
and all slaves will go back to what it was just prior to the
acceptance of the start command.
.PP
Should it not be detected until much later that the
\&\fBonline-update\fR caused unwanted changes, it is still possible to
revert to the moment the start command was issued by restoring
the system to the given checkpoint that was closed at the time of
the start.  The online-update interval occurs entirely within
its own checkpoint.
.PP
Note that the \fBcbadm online-update start\fR command should only
be issued at the master for a set of vbuckets.
.PP
\&\fBWarning:\fR during an online update, all data modifications will
be stored only in memory.  This means those changes are volatile
and means that the server will begin to send temporary \s-1OOM\s0 errors
if all memory is consumed with modified items.  It is therefore
recommended that the \fBonline-update\fR period be kept as short
as possible and that client applications of Couchbase be written to
handle temporary \s-1OOM\s0 failures.
.SH "OPERANDS"
.IX Header "OPERANDS"
host:port                 The hostname and port number of the master server.
.PP
start|revert|complete     Begin and end an online update by either reverting or completing it.
.SH "EXAMPLES"
.IX Header "EXAMPLES"
Note that in all examples, the exit value of 0 and the lack of
output to \s-1STDERR\s0 indicate success.
.Sp
.RS 4
\&\fBExample 1\fR Starting an online-update.
.Sp
.RS 2
$ /opt/couchbase/bin/cbadm\-online\-update localhost:11211 start
.RE
.RE
.RS 4
.Sp
This example starts an online-update
.Sp
\&\fBExample 2\fR Completing an online-update.
.Sp
.RS 2
$ /opt/couchbase/bin/cbadm\-online\-update localhost:11211 complete
.RE
.RE
.RS 4
.Sp
This example shows completing an \fBonline-update\fR.  After this
command is successfully received, any items changed during the
update will be persisted and part of a given checkpoint.
.Sp
\&\fBExample 3\fR Reverting an online-update.
.Sp
.RS 2
$ /opt/couchbase/bin/cbadm\-online\-update localhost:11211 Revert
.RE
.RE
.RS 4
.Sp
This example shows completing an \fBonline-update\fR.  After this
command is successfully received, any items changed during the
update will be reverted to the state they had prior to the
\&\fBonline-update start\fR command being accepted.
.RE
.SH "KNOWN LIMITATIONS"
.IX Header "KNOWN LIMITATIONS"
This command was written for and tested in an environment where
vbuckets may be explicitly defined in active or replica state on a
given server.  It is not tested for use within common Couchbase
clusters, though it may be compatible.  \fBcbadm online-update\fR is not
supported for use in common Couchbase clusters at this time.
