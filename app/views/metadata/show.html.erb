<p id="notice"><%= notice %></p>

<p>
  <h1>Name:</h1>
  <%= @metadatum.name %>
  
  <h2>Data:</h2>
  <table>
  	<% @metadatum.data.each do |datum| %>
  		<!--Data - name-->		
		<tr>
  			<td><%= @metadatum.data.first().param1 %></td>
		</tr>
		
		<!--DataColumns-->
		<%
		#TODO: what if datum has no columns?
		#base nrows off the first column
		#TODO: dynamic select of data_column_<type>
		nrows = datum.data_columns[2].data_column_ints.count
		#TODO: compute column names
		#ncols = datum.data_column_ints.count
		ncols = datum.data_columns.count
		%>
		
		<!-- display columne name -->
		<tr>
			<% for j in (0..ncols-1) %>
				<td>
					<%= datum.data_columns[j].name %>
				</td>
			<% end %>
		</tr>
	
		<% for i in (0..nrows-1) %>
		<tr>
			<% for j in (0..ncols-1) %>
				<td>
					<%
						#TODO: get type method
						if datum.data_columns[j].dtype == "integer"
					%>
							<%= datum.data_columns[j].data_column_ints[i].val %>
						<% end %>
				</td>
			<% end %>
		</tr>
		<% end %>
		
		<!--json stubs-->
		<tr>
			<% for j in (0..ncols-1) %>
				<td>
					<%= link_to 'JSON', :controller => "DataColumns", 
										:action => "get_data_column_json",
										:id => datum.id, 
										:name => datum.data_columns[j].name					
					%>
				</td>
			<% end %>
		</tr>
  <% end %>
  </table>

</p>


<%= link_to 'Edit', edit_metadatum_path(@metadatum) %> |
<%= link_to 'Back', metadata_path %>
