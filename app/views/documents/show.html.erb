<p>
  <b>Name:</b>
  <%= @document.name %>
</p>

<p>
  <b>Collection:</b>
  <%= @document.collection_id %>
</p>

<hr/>

<% 
#Get row data
@row = @document.stuffing_data.first()
#if there is no first row, set to empty instead of nil
if @row == nil
	@row = {}
end 
@colnames = get_data_colnames(@document.stuffing_data) 
%>

<%= render 'viz/visualization', :layout => 'true' %>
<hr/>

<div>
<!--Document Manip Form-->
    <%= form_tag(document_manip_path) do %>
    <%= hidden_field_tag(:id, @document[:id]) %>
<h2>Data Manipulation</h2>
<%= select_tag(:manip_func, options_for_select([ ["map","map"] ]))%>
<ul>
    <% @colnames.each do |colname|%>
        <li>
        <%= radio_button_tag("manip_colname", colname) %> 
        <%= colname %>
        </li>
    <% end %>
    <%= submit_tag("Manipulate")%>
<% end %><!--end Data Manip form-->
</ul>
</div>

<hr/>

<div>
    <h2>Data</h2>
	<!--Display data-->
	<!--TODO: make a partial-->
    <table class="table table-striped table-bordered table-condensed" style="width:0;">
        <thead><tr>
            <th><!--place holder for axis labels --></th>
    <% row_keys = [] %>
    <% if !@row.empty? %>
    	<% row_keys = @row.keys %>
    <% end %>
    <% row_keys.each do |name| %>
            <th><%= name %></th>
    <% end %>
        </tr>></thhead>
	<% @document.stuffing_data.each do |row| %>
		<tr>
			<td><!--place holder for axis labels--></td>
			<% row.values.each do |val|%>
			<td>
				<%= form_tag documents_path, :method => 'get', :id => "documents_search" do %>
    				<%= link_to val, :action => "index", :lucky_search => "lucky_search", :search => val %>
    			<% end %>
			</td>
			<% end %>
		</tr>
	<% end %>
	</table>
</div>

<%= link_to 'Edit', edit_document_path(@document) %> |
<%= link_to 'Back', documents_path %>
