<p>
  <b>Name:</b>
  <%= @document.name %>
</p>

<p>
  <b>Collection:</b>
  <%= @document.collection_id %>
</p>

<p>
	<b>Owner:</b>
	<% if @document.user %>
		<%= @document.user.email %> 
	<% end %>
</p>

<hr/>

<% 
#Get row data
@row = @paged_sdata.first()
#if there is no first row, set to empty instead of nil
if @row == nil
	@row = {}
end 
@colnames = get_data_colnames(@paged_sdata) 
%>

<div>
    <h2>Data</h2>
	<!--Display data-->
	<!--TODO: make a partial-->
	<!--TODO: documents_path is not right for this data-->
    <table id="documents" class="table table-striped table-bordered table-condensed" style="width:0;">
     <thead>
      <tr>
    	<th><!--place holder for axis labels --></th>
		    <% row_keys = [] %>
		    <% if !@row.empty? %>
		    	<% row_keys = @row.keys %>
		    <% end %>
		    <% row_keys.each do |name| %>
		    	<th><%= name %></th>
		    <% end %>
      </tr>
     </thead>
     <tbody>
		<% @paged_sdata.each do |row| %>
			<tr>
				<td><!--place holder for axis labels--></td>
				<% row.values.each do |val|%>
				<td>
					<%= form_tag documents_path, :method => 'get', :id => "documents_search" do %>
	    				<%= link_to val, :action => "index", :lucky_search => "lucky_search", :search => val %>
	    			<% end %>
				</td>
				<% end %>
			</tr>
		<% end %>
	 </tbody>
	</table>
</div>


<% if @paged_sdata != [] %>
	<%= will_paginate @paged_sdata %>
<% end %>


<%= render 'viz/visualization', :layout => 'true' %>
<hr/>

<div id="hidden_form">
<h2>Data Manipulation</h2>
<a class="btn btn-info" href="#">More</a>
<a class="btn btn-inverse" href="#">Hide</a>

<!--Document Manip Form-->
<%= form_tag(document_manip_path) do %>
	<%= hidden_field_tag(:id, @document[:id]) %>
	
	<% @colnames.each do |colname|%>
    	<%= radio_button_tag("manip_colname", colname) %> 
    	<%= colname %>
	<% end %>
	<br />
	<%= select_tag(:manip_func, options_for_select([ ["categorize","categorize"] ]))%>
	<br />
    <%= submit_tag("Manipulate")%>
<% end %><!--end Data Manip form-->
</ul>
</div>

<hr/>

<%= link_to 'Edit', edit_document_path(@document) %> |
<%= link_to 'Back', documents_path %>
